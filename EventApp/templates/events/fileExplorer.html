{% extends 'base/base.html' %}
{% load static %}
{% block title %}File Upload{% endblock %}
{% block css %}
    <link href="{% static 'events/css/campaign.css' %}" rel="stylesheet">
{% endblock %}

{% block body %}
    <br><br><br><br><br>

    <div class="container">
        <div class="col-sm-8 container-center">
            <div class="logo">
                <img class="img-fluid" src="{% static 'gandharva/img/logo_description.png' %}">
            </div>
            <h5 style="text-align: center;">File Upload</h5>
            <br>
            <form method="post" enctype="multipart/form-data">
                {% csrf_token %}
                <div class="text-left">
                    {#                    {{ form.as_p }}#}

                    {#                    <div class="input-group">#}
                    {#                    <div class="input-group-prepend">#}
                    {#                        <span class="input-group-text" id="inputGroupFileAddon01">Profile Image</span>#}
                    {#                    </div>#}
                    {#                    <div class="custom-file">#}
                    {#                        <input type="file" class="custom-file-input" id="inputGroupFile01"#}
                    {#                               aria-describedby="inputGroupFileAddon01" name="document" hidden>#}
                    {#                        <label class="custom-file-label" for="inputGroupFile01">Choose file</label>#}
                    {##}
                    {#                    </div>#}
                    {#                </div>#}
                    <div class="form-group">
                        <input type="file" name="document">
                    </div>
                    <div class="text-center">
                        <button type="submit" id="upload" class="btn btn-primary" style="margin-left: 0;width:auto;">
                            Upload
                        </button>
                    </div>
                </div>
            </form>
            {% if global %}
                <div class="text-center">
                    <a class="nav-link" href="{{ global.file.url }}">{{ global.title }} <span
                            class="sr-only">(current)</span></a>
                </div>
            {% endif %}
            <br>
            {% if documents %}
                <div class="text-center">
                    <p>Uploaded files:</p>
                </div>

                <table class="table table-responsive">
                    <thead class="thead-dark">
                    <tr>
                        <th>File Name</th>
                        <th> Upload Time</th>
                    </tr>
                    </thead>
                    <tbody>
                    {% for obj in documents %}
                        <tr>
                            <td><a href="{{ obj.document.url }}">{{ obj.fname }}</a></td>
                            <td>
                                <small>(Uploaded at: {{ obj.uploaded_at }})</small>
                            </td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
                {#            <div class="text-center">#}
                {#                <label>Documents Uploaded By Other Users</label>#}
                {#            </div>#}
                {##}
                {#            {% for sub,val in dict.items %}#}
                {#                <br>#}
                {#                <label> Name: {{ sub.first_name }} {{ sub.last_name }}</label>#}
                {##}
                {#                <table class="table table-responsive">#}
                {#                    <thead class="thead-dark">#}
                {#                    <tr>#}
                {#                        <th>File Name</th>#}
                {#                        <th> Upload Time</th>#}
                {#                    </tr>#}
                {#                    </thead>#}
                {#                    <tbody>#}
                {#                    {% for obj in val %}#}
                {#                        <tr>#}
                {#                            <td><a href="{{ obj.document.url }}">{{ obj.fname }}</a></td>#}
                {#                            <td>#}
                {#                                <small>(Uploaded at: {{ obj.uploaded_at }})</small>#}
                {#                            </td>#}
                {#                        </tr>#}
                {#                    {% endfor %}#}
                {#                    </tbody>#}
                {#                </table>#}
                {#            {% endfor %}#}
                {#        </div>#}
                </div>
            {% endif %}
        <br><br>
    </div>
    <br><br>
    <div style="height: 40vh"></div>
    {% block scripts %}
        <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
        <script type="text/javascript">
            let uploadField = document.getElementById("id_document");
            uploadField.onchange = function () {
                if (this.files[0].size > 25165824) {
                    swal("Upload size limit is 25MB.");
                    this.value = "";
                }
            };
        </script>
        {#        <script type="application/javascript">#}
        {#            $('input[type="file"]').change(function (e) {#}
        {#                var fileName = e.target.files[0].name;#}
        {#                $('.custom-file-label').html(fileName);#}
        {#            });#}
        {#        </script>#}
    {% endblock %}

{% endblock %}

